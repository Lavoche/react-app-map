(this["webpackJsonptest-level2"]=this["webpackJsonptest-level2"]||[]).push([[0],{21:function(e,t,a){e.exports=a(37)},26:function(e,t,a){},27:function(e,t,a){},33:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(2),c=a.n(o),s=a(20),i=a(19),l=a(1),u=a(3),d=a(8),m=a(10),f=a(9),p=a(4),b=function(e){var t=e.center,a=e.markers,n=e.onUpdateMarkerDetails,o=e.onUpdateCenter,c=[],s=a.map((function(e){var t=e.id,a=e.label,o=e.address,s=e.coordinates;return c.push.apply(c,[s]),r.a.createElement(p.c,{geometry:s,key:t,options:{draggable:!0},modules:["geoObject.addon.balloon"],properties:{balloonContentHeader:"".concat(a),balloonContentBody:"".concat(o)},onDragEnd:function(e){n({id:t,pos:e.get("target").geometry._coordinates})}})})),i=r.a.createElement(p.d,{geometry:c,options:{balloonCloseButton:!1,strokeColor:"#000",strokeWidth:4,strokeOpacity:.5}});return r.a.createElement(p.e,null,r.a.createElement(p.b,{defaultState:{center:t,zoom:9},onActionEnd:o,width:"100%",height:"400px"},s,i,r.a.createElement(p.a,null)))},h=(a(26),function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={label:""},e.onLabelChange=function(t){e.setState({label:t.target.value})},e.onSubmit=function(t){t.preventDefault(),e.props.onMarkerAdd(e.state.label),e.setState({label:""})},e}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.onSubmit,className:"d-flex"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0443\u043d\u043a\u0442\u0430",onChange:this.onLabelChange,value:this.state.label}),r.a.createElement("button",{className:"btn btn-outline-success add-marker"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))}}]),a}(n.Component)),v=a(11),g=(a(27),function(e){var t=e.markers,a=e.onDeleteMarker,n=e.onChangeList,o=t.map((function(e,t){var n=e.id,o=e.label;return r.a.createElement(v.b,{key:n,draggableId:n.toString(),index:t},(function(e){return r.a.createElement("li",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps,{className:"list-group-item"}),r.a.createElement("span",null,r.a.createElement("span",null,o),r.a.createElement("button",{type:"button",className:"btn btn-outline-danger btn-md float-right",onClick:function(){return a(n)}},r.a.createElement("i",{className:"fa fa-trash-o"}))))}))}));return r.a.createElement(v.a,{onDragEnd:function(e){if(e.destination){var t={startId:e.source.index,endId:e.destination.index};n(t)}}},r.a.createElement(v.c,{droppableId:"droppable"},(function(e){return r.a.createElement("ul",Object.assign({},e.droppableProps,{ref:e.innerRef,className:"list-group marker-list"}),o)})))}),k=(a(33),function(){return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("h3",{className:"text-center"},"Level II"))}),E=a(6),y=a.n(E),j=a(15),O=function e(){var t=this;Object(u.a)(this,e),this._apiBase="https://geocode-maps.yandex.ru/1.x/?apikey=b4d2c5bf-1f62-4634-b76b-ade75cee0f23&format=json&geocode=",this.getResource=function(){var e=Object(j.a)(y.a.mark((function e(a){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._apiBase).concat(a));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Couldn ot fetch ".concat(a)+", received ".concat(n.status));case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAddress=function(){var e=Object(j.a)(y.a.mark((function e(a){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource(a.reverse().join(","));case 2:return n=e.sent,e.abrupt("return",t._transformCoord(n.response));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._transformCoord=function(e){var t=e.GeoObjectCollection.featureMember[0].GeoObject,a=t.name,n=t.description;return"".concat(a,", ").concat(n)}},C=(a(35),a(36),function(){return r.a.createElement("div",{className:"error-indicator"},r.a.createElement("span",{className:"boom"},"\u0423\u043f\u0441!"),r.a.createElement("span",null,"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u043e\u043c!"))}),x=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).maxId=5,e.state={markers:[],center:[],isReady:!1,hasError:!1},e.yaGeocode=new O,e.addMarker=function(t){if(t.trim()){var a=e.yaGeocode.getAddress,n=e.createMarkerItem(t);a(e.state.center.slice(0)).then((function(t){e.setState((function(e){var a=e.markers;return n.address=t,{markers:[].concat(Object(l.a)(a),[n])}}))})).catch(e.onError)}},e.deleteMarker=function(t){e.setState((function(e){var a=e.markers,n=a.findIndex((function(e){return e.id===t}));return{markers:[].concat(Object(l.a)(a.slice(0,n)),Object(l.a)(a.slice(n+1)))}}))},e.updateCenter=function(t){var a=t.get("target").getCenter();a&&e.setState({center:a})},e.changeList=function(t){var a=t.startId,n=t.endId;n!==a&&e.setState((function(e){var t=e.markers,r=Object(l.a)(t),o=r.splice(a,1),c=Object(i.a)(o,1)[0];return r.splice(n,0,c),{markers:r}}))},e.updateMarkerDetails=function(t){var a=t.id,n=t.pos;(0,e.yaGeocode.getAddress)(n.slice(0)).then((function(t){e.setState((function(e){var r=e.markers,o=r.findIndex((function(e){return e.id===a})),c=Object(s.a)({},r[o]);return c.coordinates=n,c.address=t,{markers:[].concat(Object(l.a)(r.slice(0,o)),[c],Object(l.a)(r.slice(o+1)))}}))})).catch(e.onError)},e.onError=function(){e.setState({hasError:!0})},e}return Object(d.a)(a,[{key:"createMarkerItem",value:function(e){return{id:this.maxId++,label:e,address:"",coordinates:this.state.center}}},{key:"componentDidMount",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){var a=t.coords;e.setState({center:[a.latitude,a.longitude],isReady:!0})}),(function(){e.setState({center:[55.751574,37.573856],isReady:!0})}))}},{key:"render",value:function(){var e=this.state,t=e.markers,a=e.center,n=e.isReady,o=e.hasError,c=!o&&n?r.a.createElement(b,{center:a,onUpdateCenter:this.updateCenter,markers:t,onUpdateMarkerDetails:this.updateMarkerDetails}):null,s=o?r.a.createElement(C,null):null;return r.a.createElement("div",{className:"test-app"},r.a.createElement(k,null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-7"},c,s),r.a.createElement("div",{className:"col-md-5"},r.a.createElement(h,{onMarkerAdd:this.addMarker}),r.a.createElement(g,{markers:t,onDeleteMarker:this.deleteMarker,onChangeList:this.changeList}))))}}]),a}(n.Component);c.a.render(r.a.createElement(x,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.897a6782.chunk.js.map